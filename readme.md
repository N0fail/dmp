# Модуль ядра под ОС linux
Модуль ядра под ОС linux, который создает виртуальные блочные устройства поверх существующего на базе device mapper и следит за статистикой выполняемых операция на устройстве. Статистика доступна через sysfs модуля.

## Компиляция
Для компиляции необходимо выполнить 
```html
make
```

## Тестирование
#### Создание устройств
Для добавления модуля и создания блочных устройств можно выполнить
```html
make test_start
```
#### Просмотр текущей статистики
Чтобы узнать текущую статистику нужно выполнить
```html
cat /sys/module/dmp/stat/volumes
```
#### Запись
На каждую команду записи вызывается ~30 команд чтения

После выполнения следующей команды количество команд записи увеличится на 2(при устройстве с размером блока 4k)
```html
dd if=/dev/random of=/dev/mapper/dmp1 bs=4k count=2
```

После выполнения следующей команды количество команд записи увеличится на 1(при устройстве с размером блока 4k)
```html
dd if=/dev/random of=/dev/mapper/dmp1 bs=1k count=3
```

После выполнения следующей команды количество команд записи увеличится на 2
```html
dd if=/dev/random of=/dev/mapper/dmp1 bs=1k count=2 oflag=direct
```

#### Чтение
После выполнения следующей команды количество команд чтения увеличится на 2(при устройстве с размером блока 4k)
```html
dd if=/dev/random of=/dev/mapper/dmp1 bs=4k count=2
```

После выполнения следующей команды количество команд чтения увеличится на 1(при устройстве с размером блока 4k)
```html
dd if=/dev/random of=/dev/mapper/dmp1 bs=1k count=3
```
